<template>
  <div id="container" class="line">
    <div class="content  dynamic-layout">
      <div class="rankWrap">
        <div class="commendWrap w-100">
          <div class="commend-main-title">
            <div class="commend-main-area">
              <div class="flex-center">
                <v-icon>
                  mdi-finance
                </v-icon>
                <h3>SPOì—ì„œ ì§ì ‘ ê¸°ì—…ì„ í‰ê°€í•˜ì—¬ ì¶”ì²œí•´ì£¼ê³  ìˆëŠ” </h3><h2>ì¶”ì²œì¢…ëª©</h2>
              </div>
              <div class="commend-main-txt">
                ì¢…ëª©ë“¤ì„ ìƒì„¸íˆ ë‚˜íƒ€ë‚¸ ìƒì„¸ í˜ì´ì§€ì—ìš” ğŸ™ˆğŸ™‰
              </div>
            </div>
          </div>
          <!--          v-if="StockInfo.stockInfoSequence === $route.query.currentOrderIndex"-->
          <div class="detailsWarp">
            <div class="detailsWarpTitle">
              <div class="detailsItem">
                <span class="ItemCode">{{ stockInfo.srtnCd }} {{ stockInfo.mrktCtg }}</span>
                <h3 class="ItemName">
                  {{ stockInfo.itmsNm }}1
                </h3>
                <h1 class="ItemValue">
                  {{ stockInfo.priceInfo?.clpr }} <span>ì› <span class="plus">3.07%</span></span>
                </h1>
              </div>
              <div class="detailsItem chartWrap">
                <div class="chart">
                  <s-line-chart v-if="chartData" :options="options" :data="chartData" type="line" :height="200" />
                </div>
              </div>
            </div>
            <div class="detailsContent">
              <div class="detailsContentItem">
                <table>
                  <tr>
                    <td colspan="8">
                      ìƒì„¸ ë³´ê¸°
                    </td>
                  </tr>
                  <tr>
                    <td>ì „ì¼ì¢…ê°€</td>
                    <td>
                      146,800
                    </td>

                    <td>ì‹œê°€</td>
                    <td>
                      146,200
                    </td>

                    <td>ê³ ê°€</td>
                    <td>
                      153,200
                    </td>

                    <td>ì €ê°€</td>
                    <td>
                      146,000
                    </td>
                  </tr>

                  <tr>
                    <td>ê±°ë˜ëŸ‰</td>
                    <td>
                      146,800
                    </td>

                    <td>ê±°ë˜ëŒ€ê¸ˆ</td>
                    <td>
                      146,200
                    </td>

                    <td>ì‹œì´</td>
                    <td>
                      153,200
                    </td>

                    <td>ë§¤ì¶œì„±ì¥ë¥ </td>
                    <td>
                      146,000
                    </td>
                  </tr>

                  <tr>
                    <td>per</td>
                    <td>
                      146,800
                    </td>

                    <td>pbr</td>
                    <td>
                      146,200
                    </td>

                    <td>ìˆœì´ìµ</td>
                    <td>
                      153,200
                    </td>

                    <td>ë¶€ì±„ë¹„ìœ¨</td>
                    <td>
                      146,000
                    </td>
                  </tr>

                  <tr>
                    <td>ROE</td>
                    <td>
                      146,800
                    </td>

                    <td>ROA</td>
                    <td>
                      146,200
                    </td>

                    <td>ì‹œê°€ì´ì•¡ ê¸°ì¤€ </td>
                    <td>
                      153,200
                    </td>

                    <td>ê±°ë˜ëŒ€ê¸ˆ ë¹„ìœ¨</td>
                    <td>
                      146,000
                    </td>
                  </tr>
                </table>
              </div>
              <div class="detailsContentItem">
                <h3>ì†ìµ</h3>
                <div class="stickchart" />
              </div>
              <div class="detailsContentItem">
                <h3>ì¬ë¬´ìƒíƒœ</h3>
                <div class="stickchart" />
              </div>
              <div class="detailsContentItem">
                <h3>ê¸°ì—… ì •ë³´</h3>
                <div class="detailsInfoWrap">
                  <ul>
                    <li>
                      <p class="detailsInfoTitle">
                        ì„¤ë¦½ì¼
                      </p>
                      <p>2014.10.10</p>
                    </li>
                    <li>
                      <p class="detailsInfoTitle">
                        ëŒ€í‘œì
                      </p>
                      <p>ê¹€ë³‘í›ˆ</p>
                    </li>
                    <li>
                      <p class="detailsInfoTitle">
                        ì£¼ìš”ì‚°ì—…
                      </p>
                      <p>í™”ì¥í’ˆ ì œì¡°ì—…</p>
                    </li>
                    <li>
                      <p class="detailsInfoTitle">
                        ê¸°ì—…í˜•íƒœ
                      </p>
                      <p>ì¤‘ê²¬ê¸°ì—…</p>
                    </li>
                    <li>
                      <p class="detailsInfoTitle">
                        ì¢…ì—…ì› ìˆ˜
                      </p>
                      <p>407ëª…</p>
                    </li>
                    <li>
                      <p class="detailsInfoTitle">
                        í™ˆí˜ì´ì§€
                      </p>
                      <a>http://www.apr-in.com</a>
                    </li>
                    <li>
                      <p class="detailsInfoTitle">
                        ë³¸ì‚¬ì£¼ì†Œ
                      </p>
                      <p>
                        ì„œìš¸ ì†¡íŒŒêµ¬ ì‹ ì²œë™ 29ë²ˆì§€ 36ì¸µ
                      </p>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import { Component, Vue } from 'nuxt-property-decorator'
import _ from 'lodash'
import { IPriceInfo, IStockInfo } from '~/types/details/details'
import { getDetail } from '~/api/stock'
import SLineChart from '~/components/common/SLineChart.vue'
import ChartUtil from '~/util/ChartUtil'

@Component({
  layout: 'empty',
  components: {
    SLineChart
  }
})
export default class detail extends Vue {
  /********************************************************************************
   * Variables (Local, VUEX)
   ********************************************************************************/
  private stockInfo = {} as IStockInfo
  private stockInfoSequence = 0
  private options = ChartUtil.getLineCommonOptions()
  private chartData = {}

  /********************************************************************************
   * Life Cycle
   ********************************************************************************/
  async created() {
    this.stockInfoSequence = Number(this.$route.query.stockInfoSequence)
    await this.getDetail()
  }

  private async getDetail() {
    this.$nextTick(() => {
      this.$nuxt.$loading.start()
    })
    this.stockInfo = await getDetail(this.stockInfoSequence)
    console.log(this.stockInfo)
    this.chartData = this.setSummedData(this.stockInfo.prc15tnMonInfo)
    this.$nextTick(() => {
      this.$nuxt.$loading.finish()
    })
  }

  private setSummedData(array: any) {
    return {
      datasets: [
        {
          borderColor: 'rgba(255,173,182,0.94)',
          backgroundColor: 'rgba(250,178,183,0.94)',
          borderWidth: 2,
          lineTension: 0,
          pointRadius: 0,
          data: _.map(array, 'clpr') as any
        }
      ],

      labels: _.map(array, 'updateAt') as any
    }
  }
}

</script>
